import requests
from helpers.date import format_date

class VulnerabilityService:
    def get_vulnerabilities(self,init,end,severity=""):
        iocs = []
        url = "https://services.nvd.nist.gov/rest/json/cves/2.0/?pubStartDate="+format_date(init)+"&pubEndDate="+format_date(end)+"&cvssV3Severity=MEDIUM"
        response = requests.get(url)
        response = response.json()
        for data in response['vulnerabilities']:
            print(data)
            # for ioc_json in response[data]:
            #     ioc = Ioc(data,ioc_json["ioc_value"],ioc_json["malware_printable"],ioc_json["ioc_type"],ioc_json["threat_type"],ioc_json["first_seen_utc"],country="Unkown")
            #     iocs.append(ioc)
        #return (iocs)
        return (response)
    